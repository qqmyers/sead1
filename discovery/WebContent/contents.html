<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Contents</title>
</head>
<link href="css/bootstrap.css" rel="stylesheet">
<script src="http://code.jquery.com/jquery-1.8.1.min.js"
	type="text/javascript"></script>
<script type="text/javascript">
	function roundNumber(num, dec) {
		var result = Math.round(num * Math.pow(10, dec)) / Math.pow(10, dec);
		return result;
	}

	$(function() {
		var url = window.location.href;
		var tagID = url.substring(url.indexOf("?") + 3, url.indexOf("&"));
		var title = url.substring(url.indexOf("&") + 3);

		//alert(query);
		$.ajax({
			type : "GET",
			url : "Contents",
			dataType : "xml",
			data : "tagID=" + tagID + "&title=" + title,
			success : xmlParser
		});
		$("#pageheader").text(title);
		document.title = "Contents: " + title;

	});

	function xmlParser(xml) {

		var div_html_collections = '';
		var div_html_datasets = '';
		var title = '';
		var length = '';

		var uri = '';
		$(xml)
				.find("result")
				.each(
						function() {
							var urlToLoad = "";
							if ($(this).find("binding").each(function() {
								if ($(this).attr("name") == "tagID") {
									uri = $(this).find("uri").text();
								} else if ($(this).attr("name") == "title") {
									title = $(this).find("literal").text();
								} else if ($(this).attr("name") == "length") {
									length = $(this).find("literal").text();
								}
							}))
								;
							if (uri.indexOf("Dataset") != -1) {
								urlToLoad = "http://sead.ncsa.illinois.edu/nced/#dataset?id="
										+ uri;
								div_html_datasets += "<tr><td><i class='icon-file'></i></td><td>"
										+ "<a href='" + urlToLoad
						+ "' target='_blank'>"
										+ title
										+ "</a></td><td>"
										+ roundNumber((length/1024), 2) + " KB</td></tr>";
							} else {
								urlToLoad = "contents.html?i=" + uri + "&t="
										+ title;
								div_html_collections += "<tr><td><i class='icon-folder-close'></i></td><td>"
										+ "<a href='" + urlToLoad
						+ "'>"
										+ title
										+ "</a></td><td>N/A</td></tr>";
							}
						});
		var main_html = "<table class='table table-striped'><tbody><tr><th width='10'></th><th width='500'>File Name</th><th width='100'>Size</th></tr>"
				+ div_html_collections + div_html_datasets + "</tbody></table>";
		$("#xmlBody").html(main_html);

	}
</script>

<body>
	<div class="page-header">
		<h1 id="pageheader"></h1>
	</div>
	<div style="width: 700px; margin-top: 50px; margin-left: 100px"
		id="xmlBody"></div>
</body>
</html>